# Consignment Format

Consignments are Markdown files that record pending changes. They live in `.shipyard/consignments/` until processed by `shipyard version`.

## File Location

```
.shipyard/consignments/<id>.md
```

## File Structure

```markdown
---
id: 20240130-120000-abc123
timestamp: "2024-01-30T12:00:00Z"
packages:
  - my-api
  - shared-types
changeType: minor
metadata:
  author: dev@example.com
  issue: JIRA-123
---

Add new API endpoint for user preferences

## Overview

This change introduces a new REST endpoint for managing user preferences.

## Details

- Added `GET /api/preferences` endpoint
- Added `PUT /api/preferences` endpoint
- Updated OpenAPI spec
```

## Frontmatter Fields

The YAML frontmatter contains required metadata:

| Field | Required | Description |
|-------|----------|-------------|
| `id` | Yes | Unique identifier (generated by `shipyard add`) |
| `timestamp` | Yes | ISO 8601 creation timestamp |
| `packages` | Yes | List of affected package names |
| `changeType` | Yes | `patch`, `minor`, or `major` |
| `metadata` | No | Custom key-value pairs |

### ID Format

```
YYYYMMDD-HHMMSS-<random>
```

Example: `20240130-120000-abc123`

Generated automatically by `shipyard add` based on UTC time.

### Change Types

| Type | Description | Version Bump |
|------|-------------|--------------|
| `patch` | Bug fixes, documentation | `1.2.3` → `1.2.4` |
| `minor` | New features, backward-compatible | `1.2.3` → `1.3.0` |
| `major` | Breaking changes | `1.2.3` → `2.0.0` |

### Metadata

Custom fields defined in `shipyard.yaml` under `metadata.fields`:

```yaml
metadata:
  author: dev@example.com
  issue: JIRA-123
  priority: high
```

Values are validated against the configuration.

## Body Content

Everything after the frontmatter closing `---` is the summary and description.

- **First line**: Brief summary (used in changelogs)
- **Remaining content**: Extended description (optional)

### Summary

The first non-empty line after frontmatter becomes the consignment summary:

```markdown
---
...
---

Add new API endpoint for user preferences
```

This appears in:
- `shipyard status` output
- Generated changelogs
- Release notes
- Git tag messages

### Extended Description

Additional content is preserved in history but typically not shown in changelogs:

```markdown
---
...
---

Add new API endpoint for user preferences

## Overview

Detailed explanation of the change...

## Migration Notes

Steps users need to take...
```

## Examples

### Minimal Consignment

```markdown
---
id: 20240130-120000-abc123
timestamp: "2024-01-30T12:00:00Z"
packages:
  - my-app
changeType: patch
---

Fix null pointer exception in login handler
```

### Multi-Package Consignment

```markdown
---
id: 20240130-120000-def456
timestamp: "2024-01-30T12:00:00Z"
packages:
  - api
  - sdk
  - docs
changeType: minor
metadata:
  author: team@example.com
---

Add pagination support to list endpoints
```

### Major Change with Details

```markdown
---
id: 20240130-120000-ghi789
timestamp: "2024-01-30T12:00:00Z"
packages:
  - core
changeType: major
metadata:
  issue: BREAKING-101
---

Remove deprecated authentication methods

## Breaking Changes

- Removed `BasicAuth` class
- Removed `legacyLogin()` function
- `authenticate()` now requires OAuth2 credentials

## Migration

Replace:
```js
client.legacyLogin(user, pass)
```

With:
```js
client.authenticate({ oauth: token })
```
```

## Lifecycle

1. **Created** by `shipyard add` → saved to `.shipyard/consignments/`
2. **Listed** by `shipyard status`
3. **Processed** by `shipyard version`:
   - Archived to `.shipyard/history.json`
   - Used to generate changelog entries
   - Deleted from consignments directory

## Manual Editing

Consignment files can be edited manually before running `shipyard version`:

- Fix typos in summaries
- Adjust change types
- Add/remove packages
- Update metadata

**Warning**: Don't modify the `id` or `timestamp` fields.

## See Also

- [`add`](./reference/add.md) - Create consignments
- [`status`](./reference/status.md) - View pending consignments
- [`version`](./reference/version.md) - Process consignments
- [Configuration Reference](./configuration.md) - Metadata field definitions